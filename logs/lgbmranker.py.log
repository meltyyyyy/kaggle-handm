2022-04-23 02:30:49,805 __main__ 2 [INFO][<module>] start
2022-04-23 02:30:49,987 __main__ 1 [INFO][<module>] load data
2022-04-23 02:30:50,760 __main__ 5 [INFO][<module>] tran_df shape: (31788324, 6)
2022-04-23 02:30:50,765 __main__ 6 [INFO][<module>] tran_df head: 
       t_dat       customer_id  article_id     price  sales_channel_id  week
0 2018-09-20  1728846800780188   519773001  0.028458                 2     0
1 2018-09-20  1728846800780188   578472001  0.032525                 2     0
2 2018-09-20  2076973761519164   661795002  0.167797                 2     0
3 2018-09-20  2076973761519164   684080003  0.101678                 2     0
4 2018-09-20  2918879973994241   662980001  0.033881                 1     0
2022-04-23 02:30:50,766 __main__ 7 [INFO][<module>] arti_df shape: (105542, 25)
2022-04-23 02:30:50,773 __main__ 8 [INFO][<module>] arti_df head: 
   article_id  product_code  prod_name  product_type_no  product_type_name  \
0   108775015        108775      12855              253                  9   
1   108775044        108775      12855              253                  9   
2   108775051        108775      44846              253                  9   
3   110065001        110065       8159              306                 13   
4   110065002        110065       8159              306                 13   

   product_group_name  graphical_appearance_no  graphical_appearance_name  \
0                   0                  1010016                          0   
1                   0                  1010016                          0   
2                   0                  1010017                          3   
3                   4                  1010016                          0   
4                   4                  1010016                          0   

   colour_group_code  colour_group_name  ...  department_name  index_code  \
0                  9                  0  ...               10           0   
1                 10                  2  ...               10           0   
2                 11                 11  ...               10           0   
3                  9                  0  ...              131           7   
4                 10                  2  ...              131           7   

   index_name  index_group_no  index_group_name  section_no  section_name  \
0           0               1                 0          16            30   
1           0               1                 0          16            30   
2           0               1                 0          16            30   
3           7               1                 0          61             5   
4           7               1                 0          61             5   

   garment_group_no  garment_group_name  detail_desc  
0              1002                   2         8834  
1              1002                   2         8834  
2              1002                   2         8834  
3              1017                   4         8243  
4              1017                   4         8243  

[5 rows x 25 columns]
2022-04-23 02:30:50,774 __main__ 9 [INFO][<module>] cust_df shape: (1371980, 7)
2022-04-23 02:30:50,777 __main__ 10 [INFO][<module>] cust_df head: 
            customer_id  FN  Active  club_member_status  \
0   6883939031699146327  -1      -1                   0   
1  11246327431398957306  -1      -1                   0   
2  18439897732908966680  -1      -1                   0   
3  18352672461570950206  -1      -1                   0   
4  18162778555210377306   1       1                   0   

   fashion_news_frequency  age  postal_code  
0                       0   49         6305  
1                       0   25        33726  
2                       0   24         3247  
3                       0   54       168643  
4                       1   52       168645  
2022-04-23 02:30:50,992 __main__ 2 [INFO][<module>] test week: 104
2022-04-23 02:30:51,133 __main__ 4 [INFO][<module>] new tran_df shape: (1043390, 6)
2022-04-23 02:30:51,137 __main__ 5 [INFO][<module>] new tran_df sample: 
              t_dat      customer_id  article_id     price  sales_channel_id  \
30744934 2020-08-26  116809474287335   915529003  0.033881                 1   
30744935 2020-08-26  116809474287335   935858001  0.016932                 1   
30744936 2020-08-26  116809474287335   806131001  0.033881                 1   
30744937 2020-08-26  116809474287335   873217004  0.025407                 1   
30744938 2020-08-26  116809474287335   826498001  0.033881                 1   

          week  
30744934   101  
30744935   101  
30744936   101  
30744937   101  
30744938   101  
2022-04-23 02:31:00,822 __main__ 2 [INFO][<module>] c2week shape: (233174,)
2022-04-23 02:31:00,825 __main__ 3 [INFO][<module>] c2week: 
customer_id
28847241659200     [101, 102]
116809474287335    [101, 103]
200292573348128         [102]
272412481300040         [103]
519262836338427         [102]
Name: week, dtype: object
2022-04-23 02:31:04,666 __main__ 8 [INFO][<module>] bestseller_previous_week shape: (48, 4)
2022-04-23 02:31:04,670 __main__ 10 [INFO][<module>] bestseller_previous_week sample: 
   week  article_id  bestseller_rank     price
0   102   898694001              1.0  0.049675
1   102   933706001              2.0  0.016584
2   102   751471001              3.0  0.033308
3   102   915526001              4.0  0.033049
4   102   915529003              5.0  0.033279
2022-04-23 02:31:16,448 __main__ 15 [INFO][<module>] data info: (7203587, 38)
2022-04-23 02:31:16,456 __main__ 16 [INFO][<module>] data sample: 
       t_dat     customer_id  article_id     price  sales_channel_id  week  \
0 2020-09-03  28847241659200   925246001  0.128797                 2   102   
1 2020-08-31  28847241659200   760084003  0.025407                 1   102   
2 2020-09-03  28847241659200   898694001  0.049675                 2   102   
3 2020-09-03  28847241659200   933706001  0.016584                 2   102   
4 2020-09-03  28847241659200   751471001  0.033308                 2   102   

   purchased  bestseller_rank  product_code  prod_name  ...  section_name  \
0        1.0            999.0        925246      25454  ...            40   
1        0.0            999.0        760084       1134  ...             1   
2        0.0              1.0        898694       9956  ...             0   
3        0.0              2.0        933706      26557  ...             0   
4        0.0              3.0        751471        111  ...             0   

   garment_group_no  garment_group_name  detail_desc  FN  Active  \
0              1007                   9        27855   1       1   
1              1009                   5          847   1       1   
2              1008                  20         5794   1       1   
3              1010                   6        28245   1       1   
4              1009                   5          196   1       1   

   club_member_status  fashion_news_frequency  age  postal_code  
0                   0                       1   21        57896  
1                   0                       1   21        57896  
2                   0                       1   21        57896  
3                   0                       1   21        57896  
4                   0                       1   21        57896  

[5 rows x 38 columns]
2022-04-23 02:31:25,864 __main__ 2 [INFO][<module>] bestseller_rank:0.9908973923989173
2022-04-23 02:31:25,866 __main__ 2 [INFO][<module>] article_id:0.0027213785127272656
2022-04-23 02:31:25,869 __main__ 2 [INFO][<module>] department_no:0.0018046224807222384
2022-04-23 02:31:25,871 __main__ 2 [INFO][<module>] age:0.001432284209681195
2022-04-23 02:31:25,873 __main__ 2 [INFO][<module>] perceived_colour_value_id:0.0008006309056522836
2022-04-23 02:31:25,875 __main__ 2 [INFO][<module>] perceived_colour_master_id:0.000778906552783858
2022-04-23 02:31:25,877 __main__ 2 [INFO][<module>] product_type_no:0.0007581727962474961
2022-04-23 02:31:25,878 __main__ 2 [INFO][<module>] FN:0.00041481080464400946
2022-04-23 02:31:25,879 __main__ 2 [INFO][<module>] section_no:0.0003918013386243478
2022-04-23 02:31:34,686 __main__ 2 [INFO][<module>] sub_df shape: (1371980, 2)
2022-04-23 02:31:34,689 __main__ 3 [INFO][<module>] sub_df sample: 
                                         customer_id  \
0  00000dbacae5abe5e23885899a1fa44253a17956c6d1c3...   
1  0000423b00ade91418cceaf3b26c6af3dd342b51fd051e...   
2  000058a12d5b43e67d225668fa1f8d618c13dc232df0ca...   
3  00005ca1c9ed5f5146b52ac8639a40ca9d57aeff4d1bd2...   
4  00006413d8573cd20ed7128e53b7b13819fe5cfc2d801f...   

                                          prediction  
0  0706016001 0706016002 0372860001 0610776002 07...  
1  0706016001 0706016002 0372860001 0610776002 07...  
2  0706016001 0706016002 0372860001 0610776002 07...  
3  0706016001 0706016002 0372860001 0610776002 07...  
4  0706016001 0706016002 0372860001 0610776002 07...  
2022-04-23 02:31:36,110 __main__ 10 [INFO][<module>] submission shape: (1371980, 2)
2022-04-23 02:31:36,113 __main__ 11 [INFO][<module>] submission sample: 
                                         customer_id  \
0  00000dbacae5abe5e23885899a1fa44253a17956c6d1c3...   
1  0000423b00ade91418cceaf3b26c6af3dd342b51fd051e...   
2  000058a12d5b43e67d225668fa1f8d618c13dc232df0ca...   
3  00005ca1c9ed5f5146b52ac8639a40ca9d57aeff4d1bd2...   
4  00006413d8573cd20ed7128e53b7b13819fe5cfc2d801f...   

                                          prediction  
0  0924243001 0924243002 0918522001 0923758001 08...  
1  0924243001 0924243002 0918522001 0923758001 08...  
2  0924243001 0924243002 0918522001 0923758001 08...  
3  0924243001 0924243002 0918522001 0923758001 08...  
4  0924243001 0924243002 0918522001 0923758001 08...  
